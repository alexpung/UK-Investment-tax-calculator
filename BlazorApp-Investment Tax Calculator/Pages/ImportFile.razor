@using ViewModel;
@using Model.Interfaces;
@using Syncfusion.Blazor.Inputs

@inject LoadAndStartViewModel loadAndStartViewModel
@inject LoadedFilesStatisticsViewModel loadedFileStatisticsViewModel

<h3>Import and Export</h3>
<p>
    <SfUploader AutoUpload="false">
        <UploaderEvents ValueChange="LoadFiles"></UploaderEvents>
    </SfUploader>
</p>
<p> Number of tax events: @loadedFileStatisticsViewModel.NumberOfTaxEvents</p>
<p> Number of dividends imported: @loadedFileStatisticsViewModel.NumberOfDividends</p>
<p> Number of trades imported: @loadedFileStatisticsViewModel.NumberOfTrades</p>
<p> Number of corporate actions imported: @loadedFileStatisticsViewModel.NumberOfCorporateActions</p>

@code {
    private async Task LoadFiles(UploadChangeEventArgs args)
    {
        foreach (var file in args.Files)
        {
            await loadAndStartViewModel.LoadFile(file.File);
        }
    }
}
